
# bucketname parameter
$bucketname = New-Object -TypeName Amazon.CloudFormation.Model.Parameter
$bucketname.ParameterKey = 'BucketName'
$bucketname.ParameterValue = 'globally-unique-bucket-name'

# project value for the project tag
$project = New-Object -TypeName Amazon.CloudFormation.Model.Parameter
$project.ParameterKey = 'ProjectTag'
$project.ParameterValue = 'demo'

# region
$region = New-Object -TypeName Amazon.CloudFormation.Model.Parameter
$region.ParameterKey= 'region'

$numbers = 1

Do {

$region.ParameterValue= 'us-east-' + $numbers

$stackname='s3-stack'+ $numbers

New-CFNStack -StackName $stackname -TemplateBody $template -Parameter $bucketname, $project, $region

$numbers = $numbers + 1

(Get-CFNStack -StackName $stackname).Outputs

} While ($numbers –lt 3)

$number = 1

Do {

$region.ParameterValue= 'us-west-' + $number

$stackname='s3-stack'+ $number

New-CFNStack -StackName $stackname -TemplateBody $template -Parameter $bucketname, $project, $region

$number = $number + 1

(Get-CFNStack -StackName $stackname).Outputs

} While ($number –lt 3)
